generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User{
  id                String          @id              @default(uuid())
  createdAt         DateTime        @default(now())  @map("created_at")
  updatedAt         DateTime        @updatedAt       @map("updated_at")

  isAdmin           Boolean                          @map("is_admin")

  email             String          @unique
  name              String?

  password          String

  @@map("user")
}

model Node {
  id                String          @id               @default(cuid())
  type              NodeType
  position          Json                                                      // { x: number, y: number }
  data              Json                                                      // содержит tableName, tableColumns, tableRows, handlers

  parent            Node?           @relation("NestedNode", fields: [parentId], references: [id], onDelete: Cascade)
  parentId          String?                                                   // для вложенных нод 
  children          Node[]          @relation("NestedNode")
}

model Edge {
  id                String          @id               @default(cuid())
  source            String
  target            String
 	sourceHandle      String
  targetHandle      String
  type              String
  style             Json
}

enum NodeType {
  TankPark
  OPS
  Factory
  Object
  ParentObject
  ChildObject
}